apiVersion: cluster.x-k8s.io/v1beta1
kind: Cluster
metadata:
  name: cluster-qf-mathieu
  namespace: cluster-qf-mathieu
spec:
  clusterNetwork:
    pods:
      cidrBlocks:
        - 10.20.10.0/19
    services:
      cidrBlocks:
        - 10.10.10.0/19
  controlPlaneEndpoint:
    host: 10.20.30.40
    port: 6443
  controlPlaneRef:
    apiVersion: controlplane.cluster.x-k8s.io/v1beta2
    kind: KubeadmControlPlane
    name: cluster-qf-mathieu-cp-qj7zf
    namespace: cluster-qf-mathieu
  infrastructureRef:
    apiVersion: infrastructure.cluster.x-k8s.io/v1beta1
    kind: VSphereCluster
    name: cluster-qf-mathieu-s7gqr
    namespace: cluster-qf-mathieu
  topology:
    class: vsphere-v1.1.0
    controlPlane:
      metadata: {}
      replicas: 3
    version: v1.34.2
    workers:
      machineDeployments:
        - class: default-md-class
          metadata: {}
          name: md-0
          replicas: 3
status:
  conditions:
    - lastTransitionTime: '2025-10-21T12:33:41Z'
      status: 'True'
      type: Ready
    - lastTransitionTime: '2025-07-24T14:07:21Z'
      status: 'True'
      type: ControlPlaneInitialized
    - lastTransitionTime: '2025-08-29T15:08:50Z'
      status: 'True'
      type: ControlPlaneReady
    - lastTransitionTime: '2025-10-21T12:33:41Z'
      status: 'True'
      type: InfrastructureReady
    - lastTransitionTime: '2025-12-09T11:26:49Z'
      message: >-
        MachineDeployment(s) cluster-qf-mathieu-md-0-45wmj rollout and upgrade
        to version v1.34.2 on hold. Control plane is upgrading to version
        v1.34.2
      reason: MachineDeploymentsUpgradePending
      severity: Info
      status: 'False'
      type: TopologyReconciled
  controlPlaneReady: true
  infrastructureReady: true
  observedGeneration: 20
  phase: Provisioned
  v1beta2:
    conditions:
      - lastTransitionTime: '2025-12-09T12:34:11Z'
        message: >-
          * TopologyReconciled: MachineDeployment(s)
          cluster-qf-mathieu-md-0-45wmj rollout and upgrade to version v1.34.2
          on hold. Control plane is upgrading to version v1.34.2
        observedGeneration: 20
        reason: Available
        status: 'True'
        type: Available
      - lastTransitionTime: '2025-09-18T08:32:45Z'
        message: ''
        observedGeneration: 20
        reason: ProbeSucceeded
        status: 'True'
        type: RemoteConnectionProbe
      - lastTransitionTime: '2025-10-21T12:34:01Z'
        message: ''
        observedGeneration: 20
        reason: Ready
        status: 'True'
        type: InfrastructureReady
      - lastTransitionTime: '2025-07-24T14:07:21Z'
        message: ''
        observedGeneration: 3
        reason: Initialized
        status: 'True'
        type: ControlPlaneInitialized
      - lastTransitionTime: '2025-12-09T12:34:11Z'
        message: ''
        observedGeneration: 20
        reason: Available
        status: 'True'
        type: ControlPlaneAvailable
      - lastTransitionTime: '2025-08-18T12:23:15Z'
        message: ''
        observedGeneration: 20
        reason: Available
        status: 'True'
        type: WorkersAvailable
      - lastTransitionTime: '2025-12-09T11:26:48Z'
        message: >-
          MachineDeployment(s) cluster-qf-mathieu-md-0-45wmj rollout and upgrade
          to version v1.34.2 on hold. Control plane is upgrading to version
          v1.34.2
        observedGeneration: 20
        reason: MachineDeploymentsUpgradePending
        status: 'False'
        type: TopologyReconciled
      - lastTransitionTime: '2025-12-09T11:27:03Z'
        message: |-
          * KubeadmControlPlane cluster-qf-mathieu-cp-qj7zf:
            * Rolling out 1 not up-to-date replicas
              * Version v1.33.6, v1.34.2 required
              * KubeadmConfig is not up-to-date
              * VSphereMachine is not up-to-date
        observedGeneration: 20
        reason: RollingOut
        status: 'True'
        type: RollingOut
      - lastTransitionTime: '2025-12-09T11:48:29Z'
        message: ''
        observedGeneration: 20
        reason: NotRemediating
        status: 'False'
        type: Remediating
      - lastTransitionTime: '2025-12-09T12:34:13Z'
        message: >-
          * KubeadmControlPlane cluster-qf-mathieu-cp-qj7zf: Scaling down from 4
          to 3 replicas
        observedGeneration: 20
        reason: ScalingDown
        status: 'True'
        type: ScalingDown
      - lastTransitionTime: '2025-07-24T14:11:28Z'
        message: ''
        observedGeneration: 20
        reason: NotScalingUp
        status: 'False'
        type: ScalingUp
      - lastTransitionTime: '2025-12-09T12:39:02Z'
        message: |-
          * Machine cluster-qf-mathieu-cp-qj7zf-n4vfz:
            * Deleting: Machine deletion in progress, stage: WaitingForInfrastructureDeletion
            * Control plane components: Machine is deleting
            * EtcdMemberHealthy: Machine is deleting
          * Machine cluster-qf-mathieu-cp-qj7zf-zsvj8:
            * NodeHealthy:
              * Node.Ready: [container runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:Network plugin returns error: cni plugin not initialized, failed to initialize CSINode: error updating CSINode annotation: timed out waiting for the condition; caused by: Internal error occurred: failed calling webhook "mutation.gatekeeper.sh": failed to call webhook: Post "https://gatekeeper-webhook-service.gatekeeper.svc:443/v1/mutate?timeout=1s": context deadline exceeded]
        observedGeneration: 20
        reason: NotReady
        status: 'False'
        type: ControlPlaneMachinesReady
      - lastTransitionTime: '2025-12-05T17:18:47Z'
        message: ''
        observedGeneration: 20
        reason: Ready
        status: 'True'
        type: WorkerMachinesReady
      - lastTransitionTime: '2025-12-09T11:27:03Z'
        message: |-
          * Machine cluster-qf-mathieu-cp-qj7zf-n4vfz:
            * Version v1.33.6, v1.34.2 required
            * KubeadmConfig is not up-to-date
            * VSphereMachine is not up-to-date
        observedGeneration: 20
        reason: NotUpToDate
        status: 'False'
        type: ControlPlaneMachinesUpToDate
      - lastTransitionTime: '2025-12-05T17:18:47Z'
        message: ''
        observedGeneration: 20
        reason: UpToDate
        status: 'True'
        type: WorkerMachinesUpToDate
      - lastTransitionTime: '2025-07-24T14:03:20Z'
        message: ''
        observedGeneration: 20
        reason: NotPaused
        status: 'False'
        type: Paused
      - lastTransitionTime: '2025-07-24T14:03:20Z'
        message: ''
        observedGeneration: 20
        reason: NotDeleting
        status: 'False'
        type: Deleting
    controlPlane:
      availableReplicas: 2
      desiredReplicas: 3
      readyReplicas: 2
      replicas: 4
      upToDateReplicas: 3
    workers:
      availableReplicas: 3
      desiredReplicas: 3
      readyReplicas: 3
      replicas: 3
      upToDateReplicas: 3
