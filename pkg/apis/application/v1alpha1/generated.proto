
// This file was autogenerated by go-to-protobuf. Do not edit it manually!

syntax = 'proto2';

package github.com.argoproj.argo_cd.pkg.apis.application.v1alpha1;

import "k8s.io/apimachinery/pkg/apis/meta/v1/generated.proto";
import "k8s.io/apimachinery/pkg/runtime/generated.proto";
import "k8s.io/apimachinery/pkg/runtime/schema/generated.proto";
import "k8s.io/apimachinery/pkg/util/intstr/generated.proto";

// Package-wide variables from generator "generated".
option go_package = "v1alpha1";

// AWSAuthConfig is an AWS IAM authentication configuration
message AWSAuthConfig {
  // ClusterName contains AWS cluster name
  optional string clusterName = 1;

  // RoleARN contains optional role ARN. If set then AWS IAM Authenticator assume a role to perform cluster operations instead of the default AWS credential provider chain.
  optional string roleARN = 2;
}

// AppProject is a definition of AppProject resource.
// +genclient
// +genclient:noStatus
// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object
message AppProject {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional AppProjectSpec spec = 2;
}

// AppProjectList is list of AppProject resources
// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object
message AppProjectList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated AppProject items = 2;
}

// AppProjectSpec represents
message AppProjectSpec {
  // SourceRepos contains list of git repository URLs which can be used for deployment
  repeated string sourceRepos = 1;

  // Destinations contains list of destinations available for deployment
  repeated ApplicationDestination destinations = 2;

  // Description contains optional project description
  optional string description = 3;

  repeated ProjectRole roles = 4;

  // ClusterResourceWhitelist contains list of whitelisted cluster level resources
  repeated k8s.io.apimachinery.pkg.apis.meta.v1.GroupKind clusterResourceWhitelist = 5;

  // NamespaceResourceBlacklist contains list of blacklisted namespace level resources
  repeated k8s.io.apimachinery.pkg.apis.meta.v1.GroupKind namespaceResourceBlacklist = 6;
}

// Application is a definition of Application resource.
// +genclient
// +genclient:noStatus
// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object
message Application {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional ApplicationSpec spec = 2;

  optional ApplicationStatus status = 3;

  optional Operation operation = 4;
}

// ApplicationCondition contains details about current application condition
message ApplicationCondition {
  // Type is an application condition type
  optional string type = 1;

  // Message contains human-readable message indicating details about condition
  optional string message = 2;
}

// ApplicationDestination contains deployment destination information
message ApplicationDestination {
  // Server overrides the environment server value in the ksonnet app.yaml
  optional string server = 1;

  // Namespace overrides the environment namespace value in the ksonnet app.yaml
  optional string namespace = 2;
}

// ApplicationList is list of Application resources
// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object
message ApplicationList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated Application items = 2;
}

// ApplicationSource contains information about github repository, path within repository and target application environment.
message ApplicationSource {
  // RepoURL is the git repository URL of the application manifests
  optional string repoURL = 1;

  // Path is a directory path within the repository containing a
  optional string path = 2;

  // Environment is a ksonnet application environment name
  optional string environment = 3;

  // TargetRevision defines the commit, tag, or branch in which to sync the application to.
  // If omitted, will sync to HEAD
  optional string targetRevision = 4;

  // ComponentParameterOverrides are a list of parameter override values
  repeated ComponentParameter componentParameterOverrides = 5;

  // ValuesFiles is a list of Helm values files to use when generating a template
  repeated string valuesFiles = 6;
}

// ApplicationSpec represents desired application state. Contains link to repository with application definition and additional parameters link definition revision.
message ApplicationSpec {
  // Source is a reference to the location ksonnet application definition
  optional ApplicationSource source = 1;

  // Destination overrides the kubernetes server and namespace defined in the environment ksonnet app.yaml
  optional ApplicationDestination destination = 2;

  // Project is a application project name. Empty name means that application belongs to 'default' project.
  optional string project = 3;

  // SyncPolicy controls when a sync will be performed
  optional SyncPolicy syncPolicy = 4;
}

// ApplicationStatus contains information about application status in target environment.
message ApplicationStatus {
  optional ComparisonResult comparisonResult = 1;

  repeated DeploymentInfo history = 2;

  repeated ComponentParameter parameters = 3;

  optional HealthStatus health = 4;

  optional OperationState operationState = 5;

  repeated ApplicationCondition conditions = 6;
}

// ApplicationWatchEvent contains information about application change.
message ApplicationWatchEvent {
  optional string type = 1;

  // Application is:
  //  * If Type is Added or Modified: the new state of the object.
  //  * If Type is Deleted: the state of the object immediately before deletion.
  //  * If Type is Error: *api.Status is recommended; other types may make sense
  //    depending on context.
  optional Application application = 2;
}

// Cluster is the definition of a cluster resource
message Cluster {
  // Server is the API server URL of the Kubernetes cluster
  optional string server = 1;

  // Name of the cluster. If omitted, will use the server address
  optional string name = 2;

  // Config holds cluster information for connecting to a cluster
  optional ClusterConfig config = 3;

  // ConnectionState contains information about cluster connection state
  optional ConnectionState connectionState = 4;
}

// ClusterConfig is the configuration attributes. This structure is subset of the go-client
// rest.Config with annotations added for marshalling.
message ClusterConfig {
  // Server requires Basic authentication
  optional string username = 1;

  optional string password = 2;

  // Server requires Bearer authentication. This client will not attempt to use
  // refresh tokens for an OAuth2 flow.
  // TODO: demonstrate an OAuth2 compatible client.
  optional string bearerToken = 3;

  // TLSClientConfig contains settings to enable transport layer security
  optional TLSClientConfig tlsClientConfig = 4;

  // AWSAuthConfig contains IAM authentication configuration
  optional AWSAuthConfig awsAuthConfig = 5;
}

// ClusterList is a collection of Clusters.
message ClusterList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated Cluster items = 2;
}

// ComparisonResult is a comparison result of application spec and deployed application.
message ComparisonResult {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time comparedAt = 1;

  optional ApplicationSource comparedTo = 2;

  optional string status = 5;

  repeated ResourceState resources = 6;

  optional string revision = 7;
}

// ComponentParameter contains information about component parameter value
message ComponentParameter {
  optional string component = 1;

  optional string name = 2;

  optional string value = 3;
}

// ConnectionState contains information about remote resource connection state
message ConnectionState {
  optional string status = 1;

  optional string message = 2;

  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time attemptedAt = 3;
}

// DeploymentInfo contains information relevant to an application deployment
message DeploymentInfo {
  optional string revision = 2;

  repeated ComponentParameter componentParameterOverrides = 3;

  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time deployedAt = 4;

  optional int64 id = 5;
}

message HealthStatus {
  optional string status = 1;

  optional string statusDetails = 2;
}

// HookStatus contains status about a hook invocation
message HookStatus {
  // Name is the resource name
  optional string name = 1;

  // Kind is the resource kind
  optional string kind = 2;

  // APIVersion is the resource API version
  optional string apiVersion = 3;

  // Type is the type of hook (e.g. PreSync, Sync, PostSync, Skip)
  optional string type = 4;

  // Status a simple, high-level summary of where the resource is in its lifecycle
  optional string status = 5;

  // A human readable message indicating details about why the resource is in this condition.
  optional string message = 6;
}

// JWTToken holds the issuedAt and expiresAt values of a token
message JWTToken {
  optional int64 iat = 1;

  optional int64 exp = 2;
}

// Operation contains requested operation parameters.
message Operation {
  optional SyncOperation sync = 1;

  optional RollbackOperation rollback = 2;
}

// OperationState contains information about state of currently performing operation on application.
message OperationState {
  // Operation is the original requested operation
  optional Operation operation = 1;

  // Phase is the current phase of the operation
  optional string phase = 2;

  // Message hold any pertinent messages when attempting to perform operation (typically errors).
  optional string message = 3;

  // SyncResult is the result of a Sync operation
  optional SyncOperationResult syncResult = 4;

  // RollbackResult is the result of a Rollback operation
  optional SyncOperationResult rollbackResult = 5;

  // StartedAt contains time of operation start
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time startedAt = 6;

  // FinishedAt contains time of operation completion
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time finishedAt = 7;
}

// ParameterOverrides masks the value so protobuf can generate
// +protobuf.nullable=true
// +protobuf.options.(gogoproto.goproto_stringer)=false
message ParameterOverrides {
  // items, if empty, will result in an empty slice

  repeated ComponentParameter items = 1;
}

// ProjectRole represents a role that has access to a project
message ProjectRole {
  optional string name = 1;

  optional string description = 2;

  // Policies Stores a list of casbin formated strings that define access policies for the role in the project.
  repeated string policies = 3;

  repeated JWTToken jwtTokens = 4;
}

// Repository is a Git repository holding application configurations
message Repository {
  optional string repo = 1;

  optional string username = 2;

  optional string password = 3;

  optional string sshPrivateKey = 4;

  optional ConnectionState connectionState = 5;
}

// RepositoryList is a collection of Repositories.
message RepositoryList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated Repository items = 2;
}

message ResourceDetails {
  optional string name = 1;

  optional string kind = 2;

  optional string namespace = 3;

  optional string message = 4;

  optional string status = 5;
}

// ResourceNode contains information about live resource and its children
message ResourceNode {
  optional string state = 1;

  repeated ResourceNode children = 2;
}

// ResourceState holds the target state of a resource and live state of a resource
message ResourceState {
  optional string targetState = 1;

  optional string liveState = 2;

  optional string status = 3;

  repeated ResourceNode childLiveResources = 4;

  optional HealthStatus health = 5;
}

message RollbackOperation {
  optional int64 id = 1;

  optional bool prune = 2;

  optional bool dryRun = 3;
}

// SyncOperation contains sync operation details.
message SyncOperation {
  // Revision is the git revision in which to sync the application to.
  // If omitted, will use the revision specified in app spec.
  optional string revision = 1;

  // Prune deletes resources that are no longer tracked in git
  optional bool prune = 2;

  // DryRun will perform a `kubectl apply --dry-run` without actually performing the sync
  optional bool dryRun = 3;

  // SyncStrategy describes how to perform the sync
  optional SyncStrategy syncStrategy = 4;

  // ParameterOverrides applies any parameter overrides as part of the sync
  // If nil, uses the parameter override set in application.
  // If empty, sets no parameter overrides
  optional ParameterOverrides parameterOverrides = 5;

  // Resources describes which resources to sync
  repeated SyncOperationResource resources = 6;
}

// SyncOperationResource contains resources to sync.
message SyncOperationResource {
  optional string group = 1;

  optional string kind = 2;

  optional string name = 3;
}

// SyncOperationResult represent result of sync operation
message SyncOperationResult {
  // Resources holds the sync result of each individual resource
  repeated ResourceDetails resources = 1;

  // Revision holds the git commit SHA of the sync
  optional string revision = 2;

  // Hooks contains list of hook resource statuses associated with this operation
  repeated HookStatus hooks = 3;
}

// SyncPolicy controls when a sync will be performed in response to updates in git
message SyncPolicy {
  // Automated will keep an application synced to the target revision
  optional SyncPolicyAutomated automated = 1;
}

// SyncPolicyAutomated controls the behavior of an automated sync
message SyncPolicyAutomated {
  // Prune will prune resources automatically as part of automated sync (default: false)
  optional bool prune = 1;
}

// SyncStrategy controls the manner in which a sync is performed
message SyncStrategy {
  // Apply wil perform a `kubectl apply` to perform the sync.
  optional SyncStrategyApply apply = 1;

  // Hook will submit any referenced resources to perform the sync. This is the default strategy
  optional SyncStrategyHook hook = 2;
}

// SyncStrategyApply uses `kubectl apply` to perform the apply
message SyncStrategyApply {
  // Force indicates whether or not to supply the --force flag to `kubectl apply`.
  // The --force flag deletes and re-create the resource, when PATCH encounters conflict and has
  // retried for 5 times.
  optional bool force = 1;
}

// SyncStrategyHook will perform a sync using hooks annotations.
// If no hook annotation is specified falls back to `kubectl apply`.
message SyncStrategyHook {
  // Embed SyncStrategyApply type to inherit any `apply` options
  optional SyncStrategyApply syncStrategyApply = 1;
}

// TLSClientConfig contains settings to enable transport layer security
message TLSClientConfig {
  // Server should be accessed without verifying the TLS certificate. For testing only.
  optional bool insecure = 1;

  // ServerName is passed to the server for SNI and is used in the client to check server
  // ceritificates against. If ServerName is empty, the hostname used to contact the
  // server is used.
  optional string serverName = 2;

  // CertData holds PEM-encoded bytes (typically read from a client certificate file).
  // CertData takes precedence over CertFile
  optional bytes certData = 3;

  // KeyData holds PEM-encoded bytes (typically read from a client certificate key file).
  // KeyData takes precedence over KeyFile
  optional bytes keyData = 4;

  // CAData holds PEM-encoded bytes (typically read from a root certificates bundle).
  // CAData takes precedence over CAFile
  optional bytes caData = 5;
}

